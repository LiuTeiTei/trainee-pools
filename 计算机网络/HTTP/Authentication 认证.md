## HTTP Authentication 协议

HTTP 提供了一套标准的身份验证框架：

+ 服务器可以用来针对客户端的请求发送质询 (challenge)，客户端根据质询提供身份验证凭证。
+ 质询与应答的工作流程如下：
  + 服务器端向客户端返回 401（Unauthorized，未授权）状态码，并在 WWW-Authenticate 头中添加如何进行验证的信息，其中至少包含有一种质询方式。
  + 然后客户端可以在请求中添加Authorization 头进行验证，其 Value 为身份验证的凭证信息。

由于 HTTP 是无状态的，对于每一个请求，你是谁就是一个问题，所以需要在每一个请求体上附带一个信息，这个信息的作用就是我是谁。

HTTP Authentication 协议约定在 Header 中加入一个条目，然后约定 Key 和 Value 的格式。

### Request Header Field

把 Key 称为 Request Header Field，有以下字段：

- [Authenticate](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Authorization) 
- [WWW-Authenticate](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/WWW-Authenticate)
- [Proxy-Authorization](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Proxy-Authorization)
- [Proxy-Authenticate](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Proxy-Authenticate)

### Authorization Scheme

而 Value 中的格式又是千变万化的，为此，又有不同的标准出现，于是就有了 `Authorization Scheme` 来进行区分。Value 的格式则为：`scheme auth-token` 。

Scheme 常见的有：

+ [Basic](https://tools.ietf.org/html/rfc7617)
+ [Bearer](https://tools.ietf.org/html/rfc6750)
+ Digest
+ HOBA
+ Mutual
+ AWS4-HMAC-SHA256
+ [OAuth](https://tools.ietf.org/html/rfc5849#section-3.5.1)

#### Basic

+ 将用户名密码使用 BASE64 编码后作为验证凭证。

+ Basic authentication is a simple authentication scheme built into the HTTP protocol. The client sends HTTP requests with the Authorization header that contains the word Basic word followed by a space and a base64-encoded string username:password. For example:

  ```bash
  b64(zhiming:123465) = emhpbWluZzoxMjM0NjU=
  
  Authorization: Basic emhpbWluZzoxMjM0NjU=
  ```

#### Bearer

**什么是 Bearer Authentication**

+ 是一个字符串，即不关心你是 base64，也不关心有没有意义。

+ Bearer authentication (also called token authentication) is an HTTP authentication scheme that involves security tokens called bearer tokens. The name “Bearer authentication” can be understood as “give access to the bearer of this token.”

+ The bearer token is a cryptic string, usually generated by the server in response to a login request. The client must send this token in the Authorization header when making requests to protected resources:

  ```
  Authorization: Bearer <token>
  ```

+ Similarly to Basic authentication, Bearer authentication should only be used over HTTPS (SSL).

**使用 Bearer Authentication 的好处**

- CORS: cookies + CORS 并不能跨不同的域名。而Bearer验证在任何域名下都可以使用HTTP header头部来传输用户信息。
- 对移动端友好: 当你在一个原生平台(iOS, Android, WindowsPhone等)时，使用Cookie验证并不是一个好主意，因为你得和Cookie容器打交道，而使用Bearer验证则简单的多。
- CSRF: 因为Bearer验证不再依赖于cookies, 也就避免了跨站请求攻击。
- 标准：在Cookie认证中，用户未登录时，返回一个302到登录页面，这在非浏览器情况下很难处理，而Bearer验证则返回的是标准的401 challenge。

#### Digest

+ 是Basic的升级版，更加安全，因为Basic是明文传输密码信息，而Digest是加密后传输；





## Reference Links

+ [博文：HTTP Authentication](http://blog.lanvige.com/2018/02/03/http-authentication/)

